<template>
  <div id="app">
  	<!-- login window -->
	<div @keyup.enter="doLogin">
		<el-dialog title="登陆"
		  :close-on-click-modal="false"
		  :close-on-press-escape="false"
		  :show-close="false"
		  v-model="loginVisible">
		  <el-form :model="form">
		    <el-form-item label="账号">
		      <el-input v-model="form.userName" auto-complete="off"></el-input>
		    </el-form-item>
		    <el-form-item label="密码">
			  <el-input v-model="psw" 
				  type="password" 
				  auto-complete="off">
			  </el-input>
		    </el-form-item>
		  </el-form>
		  <span slot="footer" class="dialog-footer">
		    <el-button type="primary" @click.native="doLogin">确 定</el-button>
		  </span>
		</el-dialog>
	</div>
  <!-- header导航 -->	
  <el-menu router theme="dark" :default-active="activeIndex" class="el-menu-demo" mode="horizontal" @select="handleSelect">
	  <el-menu-item index="info">ESAP综合试题</el-menu-item>
	  <!-- <el-submenu index="2">
	    <template slot="title">微信模块</template>
	    <el-menu-item index="wxtx">提醒</el-menu-item>
	    <el-menu-item index="wxcx">查询</el-menu-item>
	    <el-menu-item index="wxtk">图库</el-menu-item>
	    <el-menu-item index="wxqd">签到</el-menu-item>
	    <el-menu-item index="wxyj">意见</el-menu-item>
	  </el-submenu> -->
	  <!-- <el-menu-item index="wxtxl">通讯录</el-menu-item> -->
	  <!-- <el-menu-item index="email">Email</el-menu-item> -->
	  <!-- <el-menu-item index="5"><a href="https://esap.vip" target="_blank">访问官网</a></el-menu-item> -->
	  <span class="right" v-show="!!$store.state.userName">
		{{"欢迎您，" + $store.state.userName}}
	  <a @click="$store.dispatch('outlogin')">退出登陆</a>
      </span>
	</el-menu>
	<!-- 步骤显示 -->
	<div class="progress">
	  <el-steps :space="100" :active="$store.state.active" finish-status="success">
	    <el-step title="准备"></el-step>
	    <el-step title="DDI"></el-step>
	    <el-step title="GLPA"></el-step>
	    <el-step title="MBTI"></el-step>
	    <el-step title="VDA"></el-step>
	    <el-step title="BTR"></el-step>
	  </el-steps>
	</div>
	<div class="mainbody">
	<keep-alive>
      <router-view></router-view>
    </keep-alive>
    </div>
  </div>
</template>

<script>
// import eDialog from './components/e-dialog'
import md5 from 'md5'
export default {
  	name: 'app',
  	// components: { eDialog },
  	data() {
	  return {
	  	psw:'',
	    activeIndex: '1',
	    activeIndex2: '1',
	    form: { userName: '', psw: '' },
	  };
	},
	computed: {
		loginVisible() {
			return !this.$store.getters.isLogin
		}
	},
	methods: {
		handleSelect(key, keyPath) {
		console.log(key, keyPath);
		},
		doLogin() {
			this.form.psw=md5(this.psw);
			this.$store.dispatch('doLogin',this.form)
			console.log(JSON.stringify(this.form));
		}
	},
}
</script>

<style lang="stylus">
.mainbody
	margin: 10px
#app
	font-family: 'Avenir', Helvetica, Arial, sans-serif
	-webkit-font-smoothing: antialiased
	-moz-osx-font-smoothing: grayscale
	color: #2c3e50
	margin-top: 10px
.progress 
	margin: 10px
	text-align: center
.float-footer 
	text-align: center
.right 
	margin: 15px
	float: right
	color: #fff
	font-size: 14px
	a 
		font-size: 12px
		color: #69f
		cursor: pointer
		margin: 0 5px
</style>
